{"ast":null,"code":"import { Path } from '../../../../config';\nimport { Rating, DinamicRating, DinamicReviews } from '../../../../functions';\nimport * as i0 from \"@angular/core\";\nfunction ReviewsComponent_div_10_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 12);\n  }\n  if (rf & 2) {\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate3(\"src\", \"\", ctx_r1.path, \"img/users/\", item_r1.name, \"/\", item_r1.image, \"\", i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ReviewsComponent_div_10_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 12);\n  }\n  if (rf & 2) {\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate(\"src\", item_r1.image, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ReviewsComponent_div_10_img_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 12);\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"\", ctx_r1.path, \"img/users/default/default.png\", i0.ɵɵsanitizeUrl);\n  }\n}\nfunction ReviewsComponent_div_10_h4_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1, \"Anonimous\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ReviewsComponent_div_10_h4_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r1.name);\n  }\n}\nfunction ReviewsComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtemplate(1, ReviewsComponent_div_10_img_1_Template, 1, 4, \"img\", 8)(2, ReviewsComponent_div_10_img_2_Template, 1, 1, \"img\", 8)(3, ReviewsComponent_div_10_img_3_Template, 1, 2, \"img\", 8);\n    i0.ɵɵelementStart(4, \"div\", 9);\n    i0.ɵɵelement(5, \"select\", 10);\n    i0.ɵɵtemplate(6, ReviewsComponent_div_10_h4_6_Template, 2, 0, \"h4\", 11)(7, ReviewsComponent_div_10_h4_7_Template, 2, 1, \"h4\", 11);\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    const lastIndex_r3 = ctx.last;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", item_r1.image != undefined && item_r1.method == \"direct\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", item_r1.image != undefined && item_r1.method != \"direct\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", item_r1.image == undefined);\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"reviews\", item_r1.review);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", item_r1.name == undefined);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", item_r1.name != undefined);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.comment);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", lastIndex_r3 ? ctx_r1.callback() : \"\", \" \");\n  }\n}\nexport let ReviewsComponent = /*#__PURE__*/(() => {\n  class ReviewsComponent {\n    constructor() {\n      this.path = Path.url;\n      this.rating = [];\n      this.itemReviews = [];\n      this.render = true;\n    }\n    ngOnInit() {\n      /*=============================================\n      Rating\n      =============================================*/\n      this.rating.push(DinamicRating.fnc(this.childItem));\n      /*=============================================\n      Reviews\n      =============================================*/\n      let reviews = [];\n      reviews.push(DinamicReviews.fnc(this.rating[0]));\n      for (let i = 0; i < reviews[0].length; i++) {\n        $(\".reviewsOption\").append(`\n\t\t\t\n\t\t\t\t<option value=\"${reviews[0][i]}\">${i + 1}</option>\n\n        \t`);\n      }\n      Rating.fnc();\n      /*=============================================\n      Total Reviews\n      =============================================*/\n      this.totalReviews = JSON.parse(this.childItem[\"reviews\"]).length;\n      /*=============================================\n      Star Block\n      =============================================*/\n      //Necesitamos un array vacío para almacenar los review\n      let arrayReview = [];\n      JSON.parse(this.childItem[\"reviews\"]).forEach(rev => {\n        arrayReview.push(rev.review);\n      });\n      //Ordenamos el array de mayor a menor    \n      arrayReview.sort();\n      let objectStar = {\n        \"1\": 0,\n        \"2\": 0,\n        \"3\": 0,\n        \"4\": 0,\n        \"5\": 0\n      };\n      //Identificamos que valores se repitem y cuales no se repiten   \n      arrayReview.forEach((value, index, arr) => {\n        //Tomamos del array completo el primer índice de cada valor\n        let first_index = arr.indexOf(value);\n        //Tomamos del array completo el último índice de cada valor\n        let last_index = arr.lastIndexOf(value);\n        //Comparamos si tanto el primer índice como el último índice del mismo valor son diferentes, Si es diferente significa que se repite varias veces, si son iguales significa que nunca se repite\n        if (first_index !== last_index) {\n          //incrementamos valores repetidos en las propiedades del objeto Star\n          objectStar[value] += 1;\n        } else {\n          //incrementamos valores que no se repiten en las propiedades del objeto Star\n          objectStar[value] += 1;\n        }\n      });\n      //Hacemos un recorrido por cada uno de los renglones de estrellas\n      for (let i = 5; i > 0; i--) {\n        //Hacemos una regla de 3: la cantidad que suma cada estella multiplicado por 100 dividido la cantidad de calificaciones\n        let starPercentage = Math.round(objectStar[i] * 100 / arrayReview.length);\n        if (isNaN(starPercentage)) {\n          starPercentage = 0;\n        }\n        $(\".ps-block--average-rating\").append(`\n\t\t\t\t\n\t\t\t<div class=\"ps-block__star\">\n\n            \t<span>${i} Star</span>\n\n                <div class=\"ps-progress\" data-value=\"${starPercentage}\">\n\n                \t<span></span>\n\n                </div>\n\n                <span>${starPercentage}%</span>\n\n            </div>\n\n\t    \t`);\n      }\n      /*=============================================\n      Enviamos a la vista las reseñas del producto\n      =============================================*/\n      this.itemReviews.push(JSON.parse(this.childItem[\"reviews\"]));\n    }\n    callback() {\n      if (this.render) {\n        this.render = false;\n        let reviews = $(\"[reviews]\");\n        for (let i = 0; i < reviews.length; i++) {\n          for (let r = 0; r < 5; r++) {\n            $(reviews[i]).append(`\n\t\t\t\t\t\t\n\t\t\t\t\t\t<option value=\"2\">${r + 1}</option>\n\n\t\t        \t`);\n            if ($(reviews[i]).attr(\"reviews\") == r + 1) {\n              $(reviews[i]).children(\"option\").val(1);\n            }\n          }\n        }\n        Rating.fnc();\n      }\n    }\n    static {\n      this.ɵfac = function ReviewsComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ReviewsComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ReviewsComponent,\n        selectors: [[\"app-reviews\"]],\n        inputs: {\n          childItem: \"childItem\"\n        },\n        decls: 11,\n        vars: 3,\n        consts: [[1, \"row\"], [1, \"col-lg-5\", \"col-12\"], [1, \"ps-block--average-rating\"], [1, \"ps-block__header\"], [\"data-read-only\", \"true\", 1, \"ps-rating\", \"reviewsOption\"], [1, \"col-lg-7\", \"col-12\"], [\"class\", \"media border p-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"media\", \"border\", \"p-3\"], [\"class\", \"mr-5 mt-1 rounded-circle\", \"style\", \"width:60px;\", 3, \"src\", 4, \"ngIf\"], [1, \"media-body\"], [\"data-read-only\", \"true\", 1, \"ps-rating\"], [4, \"ngIf\"], [1, \"mr-5\", \"mt-1\", \"rounded-circle\", 2, \"width\", \"60px\", 3, \"src\"]],\n        template: function ReviewsComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"h3\");\n            i0.ɵɵtext(5);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(6, \"select\", 4);\n            i0.ɵɵelementStart(7, \"span\");\n            i0.ɵɵtext(8);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(9, \"div\", 5);\n            i0.ɵɵtemplate(10, ReviewsComponent_div_10_Template, 11, 8, \"div\", 6);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(5);\n            i0.ɵɵtextInterpolate(ctx.rating[0]);\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate1(\"\", ctx.totalReviews, \" Reviews\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.itemReviews[0]);\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return ReviewsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}