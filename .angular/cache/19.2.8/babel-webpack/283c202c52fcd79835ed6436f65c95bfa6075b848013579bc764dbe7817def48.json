{"ast":null,"code":"import { Path } from '../../../config';\nimport { Rating } from '../../../functions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/categories.service\";\nimport * as i2 from \"../../../services/sub-categories.service\";\nimport * as i3 from \"../../../services/products.service\";\nfunction HomeShowcaseComponent_div_1_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"h3\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"ul\");\n    i0.ɵɵelementStart(5, \"a\", 7);\n    i0.ɵɵtext(6, \"View All\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 8);\n    i0.ɵɵelement(8, \"div\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"div\", 9);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const category_r1 = ctx.$implicit;\n    const lastIndex_r2 = ctx.last;\n    const i_r3 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(category_r1.name);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"category-showcase\", category_r1.name);\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"products/\", category_r1.url, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵattribute(\"category-sl\", category_r1.url);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"category-pb\", category_r1.url);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", lastIndex_r2 ? ctx_r3.callback(i_r3) : \"\", \" \");\n  }\n}\nfunction HomeShowcaseComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtemplate(1, HomeShowcaseComponent_div_1_div_1_Template, 11, 7, \"div\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.categories);\n  }\n}\nfunction HomeShowcaseComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 3)(2, \"div\", 11)(3, \"div\", 12)(4, \"div\", 13);\n    i0.ɵɵelement(5, \"div\", 14)(6, \"div\", 15)(7, \"div\", 15)(8, \"div\", 16)(9, \"div\", 17)(10, \"div\", 15)(11, \"div\", 18)(12, \"div\", 15)(13, \"div\", 18)(14, \"div\", 15)(15, \"div\", 18)(16, \"div\", 15)(17, \"div\", 18)(18, \"div\", 15)(19, \"div\", 18);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 12);\n    i0.ɵɵelement(21, \"div\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"div\", 16);\n    i0.ɵɵelement(23, \"div\", 19);\n    i0.ɵɵelementEnd()()()();\n  }\n}\nexport let HomeShowcaseComponent = /*#__PURE__*/(() => {\n  class HomeShowcaseComponent {\n    constructor(categoriesService, subCategoriesService, productsService) {\n      this.categoriesService = categoriesService;\n      this.subCategoriesService = subCategoriesService;\n      this.productsService = productsService;\n      this.path = Path.url;\n      this.categories = [];\n      this.preload = false;\n      this.render = true;\n    }\n    ngOnInit() {\n      this.preload = true;\n      /*=============================================\n      Tomamos la data de las categorias\n      =============================================*/\n      let getCategories = [];\n      this.categoriesService.getData().subscribe(resp => {\n        let i;\n        for (i in resp) {\n          getCategories.push(resp[i]);\n        }\n        /*=============================================\n        Ordenamos de mayor vistas a menor vistas el arreglo de objetos\n        =============================================*/\n        getCategories.sort(function (a, b) {\n          return b.view - a.view;\n        });\n        /*=============================================\n        Filtramos hasta 6 categorías\n        =============================================*/\n        getCategories.forEach((category, index) => {\n          if (index < 6) {\n            this.categories[index] = getCategories[index];\n            this.preload = false;\n          }\n        });\n      });\n    }\n    /*=============================================\n    Función que nos avisa cuando finaliza el renderizado de Angular\n    =============================================*/\n    callback(indexes) {\n      if (this.render) {\n        this.render = false;\n        let arraySubCategories = [];\n        let arrayProducts = [];\n        let preloadSV = 0;\n        /*=============================================\n        Separar las categorías\n        =============================================*/\n        this.categories.forEach((category, index) => {\n          /*=============================================\n          Tomamos la colección de las sub-categorías filtrando con los nombres de categoría\n          =============================================*/\n          this.subCategoriesService.getFilterData(\"category\", category.name).subscribe(resp => {\n            let i;\n            for (i in resp) {\n              arraySubCategories.push({\n                \"category\": resp[i].category,\n                \"subcategory\": resp[i].name,\n                \"url\": resp[i].url\n              });\n            }\n            /*=============================================\n            Recorremos el array de objetos nuevo para buscar coincidencias con los nombres de categorías\n            =============================================*/\n            for (i in arraySubCategories) {\n              if (category.name == arraySubCategories[i].category) {\n                $(`[category-showcase='${category.name}']`).append(`\n\n\t\t\t\t\t\t\t\t<li><a href=\"products/${arraySubCategories[i].url}\">${arraySubCategories[i].subcategory}</a></li>\n\n\t\t\t\t\t\t\t`);\n              }\n            }\n          });\n          /*=============================================\n          Tomamos la colección de los productos filtrando con las url's de categorías\n          =============================================*/\n          this.productsService.getFilterDataWithLimit(\"category\", category.url, 6).subscribe(resp => {\n            let i;\n            for (i in resp) {\n              arrayProducts.push({\n                \"category\": resp[i].category,\n                \"url\": resp[i].url,\n                \"name\": resp[i].name,\n                \"image\": resp[i].image,\n                \"price\": resp[i].price,\n                \"offer\": resp[i].offer,\n                \"reviews\": resp[i].reviews,\n                \"stock\": resp[i].stock,\n                \"vertical_slider\": resp[i].vertical_slider\n              });\n            }\n            /*=============================================\n            Recorremos el array de objetos nuevo para buscar coincidencias con las url de categorías\n            =============================================*/\n            for (i in arrayProducts) {\n              if (category.url == arrayProducts[i].category) {\n                /*=============================================\n                Definimos si el precio del producto tiene oferta o no\n                =============================================*/\n                let price;\n                let type;\n                let value;\n                let offer;\n                let disccount = \"\";\n                let offerDate;\n                let today = new Date();\n                if (arrayProducts[i].offer != \"\") {\n                  offerDate = new Date(parseInt(JSON.parse(arrayProducts[i].offer)[2].split(\"-\")[0]), parseInt(JSON.parse(arrayProducts[i].offer)[2].split(\"-\")[1]) - 1, parseInt(JSON.parse(arrayProducts[i].offer)[2].split(\"-\")[2]));\n                  if (today < offerDate) {\n                    type = JSON.parse(arrayProducts[i].offer)[0];\n                    value = JSON.parse(arrayProducts[i].offer)[1];\n                    if (type == \"Disccount\") {\n                      offer = (arrayProducts[i].price - arrayProducts[i].price * value / 100).toFixed(2);\n                    }\n                    if (type == \"Fixed\") {\n                      offer = value;\n                      value = Math.round(offer * 100 / arrayProducts[i].price);\n                    }\n                    disccount = `<div class=\"ps-product__badge\">-${value}%</div>`;\n                    price = `<p class=\"ps-product__price sale\">$${offer} <del>$${arrayProducts[i].price} </del></p>`;\n                  } else {\n                    price = `<p class=\"ps-product__price\">$${arrayProducts[i].price} </p>`;\n                  }\n                } else {\n                  price = `<p class=\"ps-product__price\">$${arrayProducts[i].price} </p>`;\n                }\n                /*=============================================\n                Calculamos el total de las calificaciones de las reseñas\n                =============================================*/\n                let totalReview = 0;\n                for (let f = 0; f < JSON.parse(arrayProducts[i].reviews).length; f++) {\n                  totalReview += Number(JSON.parse(arrayProducts[i].reviews)[f][\"review\"]);\n                }\n                /*=============================================\n                Imprimimos el total de las calficiaciones para cada producto\n                =============================================*/\n                let rating = Math.round(totalReview / JSON.parse(arrayProducts[i].reviews).length);\n                /*=============================================\n                Definimos si el producto tiene stock\n                =============================================*/\n                if (arrayProducts[i].stock == 0) {\n                  disccount = `<div class=\"ps-product__badge out-stock\">Out Of Stock</div>`;\n                }\n                /*=============================================\n                Imprimimos los productos en el HTML\n                =============================================*/\n                $(`[category-pb='${arrayProducts[i].category}']`).append(`\n\n\t\t\t\t\t\t\t\t <div class=\"ps-product ps-product--simple\">\n\n\t\t\t\t                    <div class=\"ps-product__thumbnail\">\n\n\t\t\t\t                    \t<a href=\"product/${arrayProducts[i].url}\">\n\n\t\t\t\t                    \t\t<img src=\"assets/img/products/${arrayProducts[i].category}/${arrayProducts[i].image}\" alt=\"\">\n\n\t\t\t\t                    \t</a>\n\n\t\t\t\t                        ${disccount}\n\n\t\t\t\t                    </div>\n\n\t\t\t\t                    <div class=\"ps-product__container\">\n\n\t\t\t\t                        <div class=\"ps-product__content\" data-mh=\"clothing\">\n\n\t\t\t\t                        \t<a class=\"ps-product__title\" href=\"product/${arrayProducts[i].url}\">${arrayProducts[i].name}</a>\n\n\t\t\t\t                            <div class=\"ps-product__rating\">\n\n\t\t\t\t                                <select class=\"ps-rating productRating\" data-read-only=\"true\">\n\n\t\t\t\t                                </select>\n\n\t\t\t\t                                <span>${rating}</span>\n\n\t\t\t\t                            </div>\n\n\t\t\t\t                            ${price}\n\n\t\t\t\t                        </div>\n\n\t\t\t\t                    </div>\n\n\t\t\t\t                </div> \n\n\t\t\t                `);\n                /*=============================================\n                Clasificamos la cantidad de estrellas según la calificación\n                =============================================*/\n                let arrayRating = $(\".productRating\");\n                for (let i = 0; i < arrayRating.length; i++) {\n                  for (let f = 1; f <= 5; f++) {\n                    $(arrayRating[i]).append(`<option value=\"2\">${f}</option>`);\n                    if (rating == f) {\n                      $(arrayRating[i]).children('option').val(1);\n                    }\n                  }\n                }\n                /*=============================================\n                Ejecutar funciones globales con respecto a las Reseñas\n                =============================================*/\n                Rating.fnc();\n                /*=============================================\n                Imprimimos los productos en el Vertical Slider\n                =============================================*/\n                $(`[category-sl='${arrayProducts[i].category}']`).append(`\n\n\t\t\t\t\t\t\t\t<a href=\"product/${arrayProducts[i].url}\">\n\n\t\t\t                \t\t<img src=\"assets/img/products/${arrayProducts[i].category}/vertical/${arrayProducts[i].vertical_slider}\" alt=\"\">\n\n\t\t\t                \t</a>\n\n\t\t\t\t\t\t\t`);\n                /*=============================================\n                Ejecutar funciones globales con respecto al carrusel\n                =============================================*/\n                preloadSV++;\n                if (preloadSV == (indexes + 1) * 6) {\n                  $(`[category-sl]`).addClass('ps-carousel--product-box');\n                  $(`[category-sl]`).addClass('owl-slider');\n                  $(`[category-sl]`).owlCarousel({\n                    items: 1,\n                    autoplay: true,\n                    autoplayTimeout: 7000,\n                    loop: true,\n                    nav: true,\n                    margin: 0,\n                    dots: true,\n                    navSpeed: 500,\n                    dotsSpeed: 500,\n                    dragEndSpeed: 500,\n                    navText: [\"<i class='icon-chevron-left'></i>\", \"<i class='icon-chevron-right'></i>\"]\n                  });\n                }\n              }\n            }\n          });\n        });\n      }\n    }\n    static {\n      this.ɵfac = function HomeShowcaseComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || HomeShowcaseComponent)(i0.ɵɵdirectiveInject(i1.CategoriesService), i0.ɵɵdirectiveInject(i2.SubCategoriesService), i0.ɵɵdirectiveInject(i3.ProductsService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: HomeShowcaseComponent,\n        selectors: [[\"app-home-showcase\"]],\n        decls: 3,\n        vars: 2,\n        consts: [[1, \"ps-section--gray\"], [\"class\", \"container\", 4, \"ngIf\"], [\"class\", \"d-flex justify-content-center\", 4, \"ngIf\"], [1, \"container\"], [\"class\", \"ps-block--products-of-category\", 4, \"ngFor\", \"ngForOf\"], [1, \"ps-block--products-of-category\"], [1, \"ps-block__categories\"], [1, \"ps-block__more-link\", 3, \"routerLink\"], [1, \"ps-block__slider\"], [1, \"ps-block__product-box\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"ph-item\"], [1, \"ph-col-2\"], [1, \"ph-row\"], [1, \"ph-col-12\", \"big\"], [1, \"ph-col-12\", \"empty\"], [1, \"ph-col-8\"], [1, \"ph-col-4\", \"empty\"], [1, \"ph-col-12\"], [1, \"ph-picture\", 2, \"height\", \"500px\"]],\n        template: function HomeShowcaseComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0);\n            i0.ɵɵtemplate(1, HomeShowcaseComponent_div_1_Template, 2, 1, \"div\", 1)(2, HomeShowcaseComponent_div_2_Template, 24, 0, \"div\", 2);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.preload);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.preload);\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return HomeShowcaseComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}