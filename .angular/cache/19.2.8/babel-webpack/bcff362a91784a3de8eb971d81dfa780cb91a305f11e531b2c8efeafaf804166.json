{"ast":null,"code":"import { Path } from '../../../../config';\nimport { DinamicPrice, Sweetalert } from '../../../../functions';\nimport { Subject } from 'rxjs';\nimport notie from 'notie';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/users.service\";\nimport * as i2 from \"../../../../services/products.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../../../../services/stores.service\";\nfunction AccountWishlistComponent_li_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"a\", 9);\n    i0.ɵɵtext(2, \"My Store\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AccountWishlistComponent_li_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"a\", 10);\n    i0.ɵɵtext(2, \"My Store\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AccountWishlistComponent_li_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"a\", 11);\n    i0.ɵɵtext(2, \"My Sales\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AccountWishlistComponent_tr_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 12);\n    i0.ɵɵtext(2, \"You haven't products in the wishlist yet!\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AccountWishlistComponent_tr_25_span_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵtext(1, \"Out-stock\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AccountWishlistComponent_tr_25_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 26);\n    i0.ɵɵtext(1, \"In-stock\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AccountWishlistComponent_tr_25_a_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 27);\n    i0.ɵɵlistener(\"click\", function AccountWishlistComponent_tr_25_a_15_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const product_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.addShoppingCart(product_r3.url, 1, []));\n    });\n    i0.ɵɵtext(1, \" Add to cart \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AccountWishlistComponent_tr_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"div\", 13)(3, \"div\", 14)(4, \"a\", 15);\n    i0.ɵɵelement(5, \"img\", 16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 17)(7, \"a\", 15);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(9, \"td\", 18);\n    i0.ɵɵelement(10, \"div\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtemplate(12, AccountWishlistComponent_tr_25_span_12_Template, 2, 0, \"span\", 20)(13, AccountWishlistComponent_tr_25_span_13_Template, 2, 0, \"span\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtemplate(15, AccountWishlistComponent_tr_25_a_15_Template, 2, 0, \"a\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\")(17, \"a\", 23);\n    i0.ɵɵlistener(\"confirm\", function AccountWishlistComponent_tr_25_Template_a_confirm_17_listener() {\n      const product_r3 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.removeProduct(product_r3.url));\n    });\n    i0.ɵɵelement(18, \"i\", 24);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const product_r3 = ctx.$implicit;\n    const i_r5 = ctx.index;\n    const lastIndex_r6 = ctx.last;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"product/\", product_r3.url, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate3(\"src\", \"\", ctx_r3.path, \"img/products/\", product_r3.category, \"/\", product_r3.image, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate(\"alt\", product_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"href\", \"product/\", product_r3.url, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", product_r3.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"innerHTML\", ctx_r3.price[i_r5][0], i0.ɵɵsanitizeHtml);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", product_r3.stock == 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", product_r3.stock > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", product_r3.stock > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"popoverMessage\", ctx_r3.popoverMessage);\n    i0.ɵɵattribute(\"remove\", product_r3.url);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", lastIndex_r6 ? ctx_r3.callback() : \"\", \" \");\n  }\n}\nexport let AccountWishlistComponent = /*#__PURE__*/(() => {\n  class AccountWishlistComponent {\n    constructor(usersService, productsService, router, storesService) {\n      this.usersService = usersService;\n      this.productsService = productsService;\n      this.router = router;\n      this.storesService = storesService;\n      this.path = Path.url;\n      this.wishlist = [];\n      this.products = [];\n      this.price = [];\n      this.render = true;\n      this.is_vendor = false;\n      this.dtOptions = {};\n      this.dtTrigger = new Subject();\n      this.popoverMessage = 'Are you sure to remove it?';\n    }\n    ngOnInit() {\n      /*=============================================\n      Agregamos opciones a DataTable\n      =============================================*/\n      this.dtOptions = {\n        pagingType: 'full_numbers',\n        processing: true\n      };\n      /*=============================================\n      Seleccionamos el id del usuario\n      =============================================*/\n      this.usersService.getUniqueData(this.childItem).subscribe(resp => {\n        /*=============================================\n        Validamos si el usuario ya tiene una tienda habilitada\n        =============================================*/\n        this.storesService.getFilterData(\"username\", resp[\"username\"]).subscribe(resp => {\n          if (Object.keys(resp).length > 0) {\n            this.is_vendor = true;\n          }\n        });\n        /*=============================================\n        Validamos si existe lista de deseos\n        =============================================*/\n        if (resp[\"wishlist\"] != undefined) {\n          /*=============================================\n          Tomamos de la data la lista de deseos\n          =============================================*/\n          this.wishlist = JSON.parse(resp[\"wishlist\"]);\n          let load = 0;\n          /*=============================================\n          Realizamos un foreach en la lista de deseos\n          =============================================*/\n          if (this.wishlist.length > 0) {\n            this.wishlist.forEach(list => {\n              /*=============================================\n              Filtramos la data de productos\n              =============================================*/\n              this.productsService.getFilterData(\"url\", list).subscribe(resp => {\n                /*=============================================\n                recorremos la data de productos\n                =============================================*/\n                for (const i in resp) {\n                  load++;\n                  /*=============================================\n                  agregamos los productos\n                  =============================================*/\n                  this.products.push(resp[i]);\n                  /*=============================================\n                  validamos los precios en oferta\n                  =============================================*/\n                  this.price.push(DinamicPrice.fnc(resp[i]));\n                  /*=============================================\n                  preguntamos cuando termina de cargar toda la data en el DOM\n                  =============================================*/\n                  if (load == this.wishlist.length) {\n                    this.dtTrigger.next();\n                  }\n                }\n              });\n            });\n          }\n        }\n      });\n    }\n    /*=============================================\n    Removemos el producto de la lista de deseos\n    =============================================*/\n    removeProduct(product) {\n      /*=============================================\n      Buscamos coincidencia para remover el producto\n      =============================================*/\n      this.wishlist.forEach((list, index) => {\n        if (list == product) {\n          this.wishlist.splice(index, 1);\n        }\n      });\n      /*=============================================\n      Actualizamos en Firebase la lista de deseos\n      =============================================*/\n      let body = {\n        wishlist: JSON.stringify(this.wishlist)\n      };\n      this.usersService.patchData(this.childItem, body).subscribe(resp => {\n        if (resp[\"wishlist\"] != \"\") {\n          Sweetalert.fnc(\"success\", \"Product removed\", \"account\");\n        }\n      });\n    }\n    /*=============================================\n    Callback\n    =============================================*/\n    callback() {\n      if (this.render) {\n        this.render = false;\n        if (window.matchMedia(\"(max-width:991px)\").matches) {\n          let localWishlist = this.wishlist;\n          let localUsersService = this.usersService;\n          let localChildItem = this.childItem;\n          $(document).on(\"click\", \".removeProduct\", function () {\n            let product = $(this).attr(\"remove\");\n            notie.confirm({\n              text: \"Are you sure to remove it?\",\n              cancelCallback: function () {\n                return;\n              },\n              submitCallback: function () {\n                /*=============================================\n                Buscamos coincidencia para remover el producto\n                =============================================*/\n                localWishlist.forEach((list, index) => {\n                  if (list == product) {\n                    localWishlist.splice(index, 1);\n                  }\n                });\n                /*=============================================\n                Actualizamos en Firebase la lista de deseos\n                =============================================*/\n                let body = {\n                  wishlist: JSON.stringify(localWishlist)\n                };\n                localUsersService.patchData(localChildItem, body).subscribe(resp => {\n                  if (resp[\"wishlist\"] != \"\") {\n                    Sweetalert.fnc(\"success\", \"Product removed\", \"account\");\n                  }\n                });\n              }\n            });\n          });\n        }\n      }\n    }\n    /*=============================================\n    Función para agregar productos al carrito de compras\n    =============================================*/\n    addShoppingCart(product, unit, details) {\n      let url = this.router.url;\n      let item = {\n        product: product,\n        unit: unit,\n        details: details,\n        url: url\n      };\n      this.usersService.addSoppingCart(item);\n    }\n    /*=============================================\n    Destruímos el trigger de angular\n    =============================================*/\n    ngOnDestroy() {\n      this.dtTrigger.unsubscribe();\n    }\n    static {\n      this.ɵfac = function AccountWishlistComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AccountWishlistComponent)(i0.ɵɵdirectiveInject(i1.UsersService), i0.ɵɵdirectiveInject(i2.ProductsService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.StoresService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AccountWishlistComponent,\n        selectors: [[\"app-account-wishlist\"]],\n        inputs: {\n          childItem: \"childItem\"\n        },\n        decls: 26,\n        vars: 7,\n        consts: [[1, \"ps-section__content\"], [1, \"ps-section__links\"], [1, \"active\"], [\"href\", \"/account\"], [\"href\", \"/account/my-shopping\"], [4, \"ngIf\"], [1, \"table-responsive\"], [\"datatable\", \"\", \"width\", \"100%\", 1, \"table\", \"ps-table--whishlist\", \"dt-responsive\", 3, \"dtOptions\", \"dtTrigger\"], [4, \"ngFor\", \"ngForOf\"], [\"href\", \"/account/new-store\"], [\"href\", \"/account/my-store\"], [\"href\", \"/account/my-sales\"], [\"colspan\", \"3\", 1, \"text-center\"], [1, \"ps-product--cart\"], [1, \"ps-product__thumbnail\"], [3, \"href\"], [3, \"src\", \"alt\"], [1, \"ps-product__content\"], [1, \"ps-product\"], [3, \"innerHTML\"], [\"class\", \"ps-tag ps-tag--out-stock\", 4, \"ngIf\"], [\"class\", \"ps-tag ps-tag--in-stock\", 4, \"ngIf\"], [\"class\", \"ps-btn\", \"style\", \"cursor:pointer\", 3, \"click\", 4, \"ngIf\"], [\"mwlConfirmationPopover\", \"\", \"placement\", \"left\", 1, \"removeProduct\", 2, \"cursor\", \"pointer\", 3, \"confirm\", \"popoverMessage\"], [1, \"icon-cross\"], [1, \"ps-tag\", \"ps-tag--out-stock\"], [1, \"ps-tag\", \"ps-tag--in-stock\"], [1, \"ps-btn\", 2, \"cursor\", \"pointer\", 3, \"click\"]],\n        template: function AccountWishlistComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"ul\", 1)(2, \"li\", 2)(3, \"a\", 3);\n            i0.ɵɵtext(4, \"My Wishlist\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(5, \"li\")(6, \"a\", 4);\n            i0.ɵɵtext(7, \"My Shopping\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(8, AccountWishlistComponent_li_8_Template, 3, 0, \"li\", 5)(9, AccountWishlistComponent_li_9_Template, 3, 0, \"li\", 5)(10, AccountWishlistComponent_li_10_Template, 3, 0, \"li\", 5);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"div\", 6)(12, \"table\", 7)(13, \"thead\")(14, \"tr\")(15, \"th\");\n            i0.ɵɵtext(16, \"Product name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"th\");\n            i0.ɵɵtext(18, \"Unit Price\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"th\");\n            i0.ɵɵtext(20, \"Stock Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(21, \"th\")(22, \"th\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(23, \"tbody\");\n            i0.ɵɵtemplate(24, AccountWishlistComponent_tr_24_Template, 3, 0, \"tr\", 5)(25, AccountWishlistComponent_tr_25_Template, 20, 17, \"tr\", 8);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", !ctx.is_vendor);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.is_vendor);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.is_vendor);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"dtOptions\", ctx.dtOptions)(\"dtTrigger\", ctx.dtTrigger);\n            i0.ɵɵadvance(12);\n            i0.ɵɵproperty(\"ngIf\", ctx.products.length == 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngForOf\", ctx.products);\n          }\n        },\n        encapsulation: 2\n      });\n    }\n  }\n  return AccountWishlistComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}